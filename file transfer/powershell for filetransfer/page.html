<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Powershel for Filetransfer</title>
</head><body>If WinRM is installed (which it usually is in a Network for Administrators to manage Computers remotely) <br/>
We have a HTTP listenener on Port 5985 and HTPPS on port 5986<br/>
<br/>
If we already have admin rights over the 2. user:<ul><li style="list-style-type: none">Create new session:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">PS C:\htb&gt; $Session = New-PSSession -ComputerName DATABASE01</li>
</ul>
</li>
<li style="list-style-type: none">Copy File from our Localhost to the DATABASE01 Sessionn:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">PS C:\htb&gt; Copy-Item -Path C:\samplefile.txt -ToSession $Session -Destination C:\Users\Administrator\Desktop\</li>
</ul>
</li>
<li style="list-style-type: none">Copy DATABASE.txt from DATABASE01 Session to our Localhost:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">PS C:\htb&gt; Copy-Item -Path "C:\Users\Administrator\Desktop\DATABASE.txt" -Destination C:\ -FromSession $Session</li>
</ul>
</li>
<li style="list-style-type: none"></li>
</ul>
Using RDP. (xfreerdp or rdesktop) from our Linux machine to either directly copy or mount.<ul><li style="list-style-type: none">Mounting a Linux Folder using rdesktop:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Momothechi@htb[/htb]$ rdesktop 10.10.10.132 -d HTB -u administrator -p 'Password0@' -r disk:linux='/home/user/rdesktop/files'</li>
</ul>
</li>
<li style="list-style-type: none">Mounting a Linux Folder using xfreerdp:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Momothechi@htb[/htb]$ xfreerdp /v:10.10.10.132 /d:HTB /u:administrator /p:'Password0@' /drive:linux,/home/plaintext/htb/academy/filetransfer</li>
</ul>
</li>
</ul>
Now on the compromised machine we have a new folder \\tsclient\linux under Network:<ul><li style="list-style-type: none">use it to transfer files from and to the RDP session.</li>
<li style="list-style-type: none"></li>
</ul>
Alternatively from Windows the native mstsc.exe remote desktop can be used.<ul><li style="list-style-type: none">-&gt; Local Resources </li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">-&gt; More</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">-&gt; Drive</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">after that we can itneract with it on the remote session that follows.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
&nbsp;</body></html>